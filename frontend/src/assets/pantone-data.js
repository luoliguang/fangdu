// 潘通色卡数据
export const pantoneColors = [
  { code: 'PANTONE 100 C', hex: '#F4ED7C', name: '嫩黄' },
  { code: 'PANTONE 101 C', hex: '#F4ED47', name: '柠檬黄' },
  { code: 'PANTONE 102 C', hex: '#F9E814', name: '金黄' },
  { code: 'PANTONE 103 C', hex: '#C6A900', name: '橄榄黄' },
  { code: 'PANTONE 104 C', hex: '#AFA000', name: '暗黄' },
  { code: 'PANTONE 105 C', hex: '#827A00', name: '深橄榄' },
  { code: 'PANTONE 106 C', hex: '#F7E859', name: '淡黄' },
  { code: 'PANTONE 107 C', hex: '#F9E526', name: '明黄' },
  { code: 'PANTONE 108 C', hex: '#FBDE00', name: '亮黄' },
  { code: 'PANTONE 109 C', hex: '#FFCC00', name: '向日葵黄' },
  { code: 'PANTONE 110 C', hex: '#D2A000', name: '金色' },
  { code: 'PANTONE 111 C', hex: '#AA8400', name: '古铜色' },
  { code: 'PANTONE 112 C', hex: '#8C7000', name: '暗金色' },
  { code: 'PANTONE 113 C', hex: '#FBE74A', name: '淡黄' },
  { code: 'PANTONE 114 C', hex: '#FBDD00', name: '亮黄' },
  { code: 'PANTONE 115 C', hex: '#FCD116', name: '向日葵黄' },
  { code: 'PANTONE 116 C', hex: '#FFBF00', name: '金黄' },
  { code: 'PANTONE 117 C', hex: '#C69214', name: '金色' },
  { code: 'PANTONE 118 C', hex: '#A07400', name: '古铜色' },
  { code: 'PANTONE 119 C', hex: '#7D5D00', name: '暗金色' },
  { code: 'PANTONE 1795 C', hex: '#E54C3C', name: '鲜红' },
  { code: 'PANTONE 1797 C', hex: '#CC3333', name: '红色' },
  { code: 'PANTONE 1807 C', hex: '#A4343A', name: '深红' },
  { code: 'PANTONE 185 C', hex: '#E63946', name: '亮红' },
  { code: 'PANTONE 186 C', hex: '#D62828', name: '鲜红' },
  { code: 'PANTONE 187 C', hex: '#BC2C2C', name: '红色' },
  { code: 'PANTONE 188 C', hex: '#8C1F28', name: '深红' },
  { code: 'PANTONE 189 C', hex: '#F26A8D', name: '粉红' },
  { code: 'PANTONE 190 C', hex: '#EF476F', name: '亮粉' },
  { code: 'PANTONE 191 C', hex: '#E83D6F', name: '玫红' },
  { code: 'PANTONE 192 C', hex: '#E71D43', name: '鲜红' },
  { code: 'PANTONE 193 C', hex: '#D30731', name: '红色' },
  { code: 'PANTONE 194 C', hex: '#AB1A36', name: '深红' },
  { code: 'PANTONE 195 C', hex: '#7A1621', name: '暗红' },
  { code: 'PANTONE 196 C', hex: '#F4C4D0', name: '浅粉' },
  { code: 'PANTONE 197 C', hex: '#F1A7BA', name: '粉红' },
  { code: 'PANTONE 198 C', hex: '#ED4975', name: '亮粉' },
  { code: 'PANTONE 199 C', hex: '#E60042', name: '鲜红' },
  { code: 'PANTONE 200 C', hex: '#C8102E', name: '红色' },
  { code: 'PANTONE 201 C', hex: '#A6192E', name: '深红' },
  { code: 'PANTONE 202 C', hex: '#8A1538', name: '暗红' },
  { code: 'PANTONE 203 C', hex: '#F5B6CD', name: '浅粉' },
  { code: 'PANTONE 204 C', hex: '#F591CF', name: '粉红' },
  { code: 'PANTONE 205 C', hex: '#F06EAA', name: '亮粉' },
  { code: 'PANTONE 206 C', hex: '#E31C79', name: '玫红' },
  { code: 'PANTONE 207 C', hex: '#CE0F69', name: '深玫红' },
  { code: 'PANTONE 208 C', hex: '#9B2242', name: '暗红' },
  { code: 'PANTONE 209 C', hex: '#862633', name: '酒红' },
  { code: 'PANTONE 210 C', hex: '#FAB8D9', name: '浅粉' },
  { code: 'PANTONE 211 C', hex: '#F890CF', name: '粉红' },
  { code: 'PANTONE 212 C', hex: '#F56EB3', name: '亮粉' },
  { code: 'PANTONE 213 C', hex: '#EA0F8B', name: '玫红' },
  { code: 'PANTONE 214 C', hex: '#CA0076', name: '深玫红' },
  { code: 'PANTONE 215 C', hex: '#AF0061', name: '暗玫红' },
  { code: 'PANTONE 216 C', hex: '#7C1E3F', name: '酒红' },
  { code: 'PANTONE 217 C', hex: '#F4C6D9', name: '浅粉' },
  { code: 'PANTONE 218 C', hex: '#EF6AAE', name: '粉红' },
  { code: 'PANTONE 219 C', hex: '#E93CAC', name: '亮粉' },
  { code: 'PANTONE 220 C', hex: '#BE0473', name: '玫红' },
  { code: 'PANTONE 221 C', hex: '#A50050', name: '深玫红' },
  { code: 'PANTONE 222 C', hex: '#83003F', name: '暗玫红' },
  { code: 'PANTONE 223 C', hex: '#F7A4CF', name: '浅粉' },
  { code: 'PANTONE 224 C', hex: '#F57FBC', name: '粉红' },
  { code: 'PANTONE 225 C', hex: '#F04E98', name: '亮粉' },
  { code: 'PANTONE 226 C', hex: '#E31C79', name: '玫红' },
  { code: 'PANTONE 227 C', hex: '#C4005F', name: '深玫红' },
  { code: 'PANTONE 228 C', hex: '#9C004A', name: '暗玫红' },
  { code: 'PANTONE 229 C', hex: '#71003F', name: '酒红' },
  { code: 'PANTONE 2925 C', hex: '#3E92CC', name: '天蓝' },
  { code: 'PANTONE 2935 C', hex: '#0063B2', name: '蓝色' },
  { code: 'PANTONE 2945 C', hex: '#004C97', name: '深蓝' },
  { code: 'PANTONE 2955 C', hex: '#003865', name: '暗蓝' },
  { code: 'PANTONE 2965 C', hex: '#00263E', name: '海军蓝' },
  { code: 'PANTONE 2975 C', hex: '#C5E8F7', name: '浅蓝' },
  { code: 'PANTONE 2985 C', hex: '#71C5E8', name: '天蓝' },
  { code: 'PANTONE 2995 C', hex: '#00A9E0', name: '亮蓝' },
  { code: 'PANTONE 3005 C', hex: '#0077C8', name: '蓝色' },
  { code: 'PANTONE 3015 C', hex: '#00629B', name: '深蓝' },
  { code: 'PANTONE 3025 C', hex: '#004F71', name: '暗蓝' },
  { code: 'PANTONE 3035 C', hex: '#003E51', name: '海军蓝' },
  { code: 'PANTONE 306 C', hex: '#00B5E2', name: '亮蓝' },
  { code: 'PANTONE 307 C', hex: '#0072C6', name: '蓝色' },
  { code: 'PANTONE 308 C', hex: '#005F86', name: '深蓝' },
  { code: 'PANTONE 309 C', hex: '#003F54', name: '暗蓝' },
  { code: 'PANTONE 310 C', hex: '#55C0E0', name: '天蓝' },
  { code: 'PANTONE 311 C', hex: '#00A7D4', name: '亮蓝' },
  { code: 'PANTONE 312 C', hex: '#0091C9', name: '蓝色' },
  { code: 'PANTONE 313 C', hex: '#007FAF', name: '深蓝' },
  { code: 'PANTONE 314 C', hex: '#006990', name: '暗蓝' },
  { code: 'PANTONE 315 C', hex: '#00586E', name: '海军蓝' },
  { code: 'PANTONE 316 C', hex: '#004851', name: '墨绿' },
  { code: 'PANTONE 317 C', hex: '#D9EBF1', name: '浅蓝' },
  { code: 'PANTONE 318 C', hex: '#A4DBE8', name: '天蓝' },
  { code: 'PANTONE 319 C', hex: '#6ECBD4', name: '亮蓝' },
  { code: 'PANTONE 320 C', hex: '#00A5B5', name: '蓝绿' },
  { code: 'PANTONE 321 C', hex: '#00839B', name: '深蓝绿' },
  { code: 'PANTONE 322 C', hex: '#006272', name: '暗蓝绿' },
  { code: 'PANTONE 323 C', hex: '#00535C', name: '墨绿' },
  { code: 'PANTONE 7729 C', hex: '#006B54', name: '深绿' },
  { code: 'PANTONE 7730 C', hex: '#006046', name: '森林绿' },
  { code: 'PANTONE 7731 C', hex: '#005239', name: '暗绿' },
  { code: 'PANTONE 7732 C', hex: '#004D2A', name: '墨绿' },
  { code: 'PANTONE 7733 C', hex: '#004618', name: '深墨绿' },
  { code: 'PANTONE 7734 C', hex: '#1B4D3E', name: '暗绿' },
  { code: 'PANTONE 7735 C', hex: '#3E5542', name: '橄榄绿' },
  { code: 'PANTONE 7736 C', hex: '#6BA539', name: '草绿' },
  { code: 'PANTONE 7737 C', hex: '#48A23F', name: '亮绿' },
  { code: 'PANTONE 7738 C', hex: '#319B42', name: '绿色' },
  { code: 'PANTONE 7739 C', hex: '#3D9238', name: '深绿' },
  { code: 'PANTONE 7740 C', hex: '#368F2B', name: '森林绿' },
  { code: 'PANTONE 7741 C', hex: '#3A8124', name: '暗绿' },
  { code: 'PANTONE 7742 C', hex: '#4A7729', name: '橄榄绿' },
  { code: 'PANTONE 7743 C', hex: '#3F6826', name: '深橄榄绿' },
  { code: 'PANTONE 7744 C', hex: '#A09000', name: '橄榄黄' },
  { code: 'PANTONE 7745 C', hex: '#8F8100', name: '暗黄' },
  { code: 'PANTONE 7746 C', hex: '#7C7200', name: '橄榄' },
  { code: 'PANTONE 7747 C', hex: '#6A6400', name: '深橄榄' },
  { code: 'PANTONE 7748 C', hex: '#5C5800', name: '暗橄榄' },
  { code: 'PANTONE 7749 C', hex: '#544D26', name: '橄榄棕' },
  { code: 'PANTONE 7750 C', hex: '#4E4A23', name: '暗橄榄棕' }
];

// 计算两个颜色之间的欧几里得距离（RGB空间）
export const calculateColorDistance = (hex1, hex2) => {
  // 将HEX转换为RGB
  const rgb1 = hexToRgb(hex1);
  const rgb2 = hexToRgb(hex2);
  
  // 计算欧几里得距离
  const rDiff = rgb1.r - rgb2.r;
  const gDiff = rgb1.g - rgb2.g;
  const bDiff = rgb1.b - rgb2.b;
  
  return Math.sqrt(rDiff * rDiff + gDiff * gDiff + bDiff * bDiff);
};

// HEX转RGB
export const hexToRgb = (hex) => {
  // 移除#号
  hex = hex.replace('#', '');
  
  // 解析RGB值
  const r = parseInt(hex.substring(0, 2), 16);
  const g = parseInt(hex.substring(2, 4), 16);
  const b = parseInt(hex.substring(4, 6), 16);
  
  return {r, g, b};
};

// 查找最接近的潘通色
export const findClosestPantone = (hex) => {
  let closestColor = null;
  let minDistance = Infinity;
  
  pantoneColors.forEach(pantone => {
    const distance = calculateColorDistance(hex, pantone.hex);
    
    if (distance < minDistance) {
      minDistance = distance;
      closestColor = {
        code: pantone.code,
        hex: pantone.hex,
        name: pantone.name,
        deltaE: Math.round(distance * 10) / 10 // 保留一位小数
      };
    }
  });
  
  return closestColor;
};