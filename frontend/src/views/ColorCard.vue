<template>
  <div class="color-card-container">
    <h1>üé® Âø´ÈÄüÊâìËâ≤Âç°</h1>
    
    <div class="main-layout">
      <!-- Â∑¶‰æßÈù¢ÊùøÔºöËâ≤ÂÄºËæìÂÖ•ÂíåËÆæÁΩÆ -->
      <div class="left-panel">
        <div class="tool-panel">
          <div class="panel-section">
            <h2>Ëâ≤ÂÄºËæìÂÖ•</h2>
            <div class="input-method-selector">
              <button 
                :class="{ active: inputMethod === 'hex' }" 
                @click="inputMethod = 'hex'"
                class="input-method"
              >
                HEX
              </button>
              <button 
                :class="{ active: inputMethod === 'rgb' }" 
                @click="inputMethod = 'rgb'"
                class="input-method"
              >
                RGB
              </button>
              <button 
                :class="{ active: inputMethod === 'cmyk' }" 
                @click="inputMethod = 'cmyk'"
                class="input-method"
              >
                CMYK
              </button>
              <button 
                :class="{ active: inputMethod === 'lab' }" 
                @click="inputMethod = 'lab'"
                class="input-method"
              >
                Lab
              </button>
            </div>
            
            <!-- HEXËæìÂÖ• -->
            <div v-if="inputMethod === 'hex'" class="input-group">
              <label>HEXÂÄº:</label>
              <div class="color-input-wrapper">
                <input 
                  type="text" 
                  v-model="currentColor.hex" 
                  @input="handleHexChange"
                  placeholder="#FFFFFF"
                />
                <input 
                  type="color" 
                  v-model="currentColor.hex" 
                  @input="handleHexChange"
                  class="color-picker modern-picker"
                />
              </div>
              <div class="alpha-slider">
                <label>ÈÄèÊòéÂ∫¶:</label>
                <div class="alpha-input-container">
                  <input 
                    type="range" 
                    v-model.number="currentColor.alpha" 
                    @input="updateColorWithAlpha"
                    min="0" 
                    max="1" 
                    step="0.01"
                  />
                  <div class="alpha-value-input">
                    <input 
                      type="number" 
                      v-model.number="alphaPercentage" 
                      @input="updateAlphaFromPercentage"
                      min="0" 
                      max="100"
                      class="alpha-percentage-input"
                    />
                    <span>%</span>
                  </div>
                </div>
              </div>
              <div 
                class="color-preview" 
                :style="{ backgroundColor: getColorWithAlpha(currentColor) }"
              ></div>
            </div>
            
            <!-- RGBËæìÂÖ• -->
            <div v-if="inputMethod === 'rgb'" class="input-group">
              <label>R:</label>
              <input 
                type="number" 
                v-model.number="currentColor.rgb.r" 
                @input="handleRgbChange"
                min="0" 
                max="255"
              />
              <label>G:</label>
              <input 
                type="number" 
                v-model.number="currentColor.rgb.g" 
                @input="handleRgbChange"
                min="0" 
                max="255"
              />
              <label>B:</label>
              <input 
                type="number" 
                v-model.number="currentColor.rgb.b" 
                @input="handleRgbChange"
                min="0" 
                max="255"
              />
              <div class="alpha-slider">
                <label>ÈÄèÊòéÂ∫¶:</label>
                <div class="alpha-input-container">
                  <input 
                    type="range" 
                    v-model.number="currentColor.alpha" 
                    @input="updateColorWithAlpha"
                    min="0" 
                    max="1" 
                    step="0.01"
                  />
                  <div class="alpha-value-input">
                    <input 
                      type="number" 
                      v-model.number="alphaPercentage" 
                      @input="updateAlphaFromPercentage"
                      min="0" 
                      max="100"
                      class="alpha-percentage-input"
                    />
                    <span>%</span>
                  </div>
                </div>
              </div>
              <div 
                class="color-preview" 
                :style="{ backgroundColor: getColorWithAlpha(currentColor) }"
              ></div>
            </div>
            
            <!-- CMYKËæìÂÖ• -->
            <div v-if="inputMethod === 'cmyk'" class="input-group">
              <label>C:</label>
              <input 
                type="number" 
                v-model.number="currentColor.cmyk.c" 
                @input="handleCmykChange"
                min="0" 
                max="100"
              />
              <label>M:</label>
              <input 
                type="number" 
                v-model.number="currentColor.cmyk.m" 
                @input="handleCmykChange"
                min="0" 
                max="100"
              />
              <label>Y:</label>
              <input 
                type="number" 
                v-model.number="currentColor.cmyk.y" 
                @input="handleCmykChange"
                min="0" 
                max="100"
              />
              <label>K:</label>
              <input 
                type="number" 
                v-model.number="currentColor.cmyk.k" 
                @input="handleCmykChange"
                min="0" 
                max="100"
              />
              <div 
                class="color-preview" 
                :style="{ backgroundColor: currentColor.hex }"
              ></div>
            </div>
            
            <!-- LabËæìÂÖ• -->
            <div v-if="inputMethod === 'lab'" class="input-group">
              <label>L:</label>
              <input 
                type="number" 
                v-model.number="currentColor.lab.L" 
                @input="handleLabChange"
                min="0" 
                max="100"
              />
              <label>a:</label>
              <input 
                type="number" 
                v-model.number="currentColor.lab.a" 
                @input="handleLabChange"
                min="-128" 
                max="127"
              />
              <label>b:</label>
              <input 
                type="number" 
                v-model.number="currentColor.lab.b" 
                @input="handleLabChange"
                min="-128" 
                max="127"
              />
              <div 
                class="color-preview" 
                :style="{ backgroundColor: currentColor.hex }"
              ></div>
            </div>
            
            <div class="note-input">
              <label>Â§áÊ≥®:</label>
              <input 
                type="text" 
                v-model="currentColor.note" 
                placeholder="ÈíàÂØπ‰∫éÂçï‰∏™Ëâ≤Âç°Â§áÊ≥® ÂèØÂøΩÁï•"
              />
            </div>
            
            <button class="add-button" @click="addColorCard">Ê∑ªÂä†Ëâ≤Âç°</button>
          </div>
          
          <div class="panel-section">
            <h2>Ëâ≤Âç°ËÆæÁΩÆ</h2>
            <div class="color-count-control">
              <label>Ëâ≤Âç°Êï∞ÈáèÔºàÊúÄÂ§ö100‰∏™Ôºâ:</label>
              <div class="preset-container">
                <div class="preset-buttons">
                  <button class="preset-btn" @click="setColorCount(3)">3</button>
                  <button class="preset-btn" @click="setColorCount(5)">5</button>
                  <button class="preset-btn" @click="setColorCount(7)">7</button>
                  <button class="preset-btn" @click="setColorCount(9)">9</button>
                </div>
                <div class="custom-count-input">
                  <input 
                    type="text" 
                    v-model.number="colorCount" 
                    placeholder="Ëá™ÂÆö‰πâ"
                    class="custom-input"
                    @input="validateColorCount"
                  />
                </div>
              </div>
              <button class="generate-btn" @click="generateSimilarColors">ÁîüÊàêÁõ∏‰ººËâ≤Âç°</button>
            </div>
            
            <div class="layout-control">
              <label>Â∏ÉÂ±Ä:</label>
              <button 
                :class="{ active: layoutMode === 'grid' }" 
                @click="layoutMode = 'grid'"
              >
                ÁΩëÊ†º
              </button>
              <button 
                :class="{ active: layoutMode === 'row' }" 
                @click="layoutMode = 'row'"
              >
                Ë°å
              </button>
            </div>
            
            <div class="global-note">
              <label>ÂÖ®Â±ÄÂ§áÊ≥® (ËøôÊòØÂøÖÈ°ªÁöÑ)</label>
              <textarea 
                v-model="globalNote" 
                placeholder="ËøôÈáåÂøÖÈ°ªË¶ÅÂ§áÊ≥®Ôºå‰∏çÁÑ∂Êâæ‰∏çÂà∞ÊòØÂì™‰∏Ä‰∏™ÂÆ¢Êà∑„ÄÇ"
              ></textarea>
            </div>
            
            <div class="export-control">
              <button class="export-button" @click="exportColorCards">ÂØºÂá∫Ëâ≤Âç°</button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Âè≥‰æßÈù¢ÊùøÔºöËâ≤Âç°Â±ïÁ§∫ -->
      <div class="right-panel">
        <div class="color-cards-display" :class="layoutMode">
          <!-- ÂΩìÂâçÁºñËæëÁöÑÈ¢úËâ≤ÂßãÁªàÊòæÁ§∫Âú®Á¨¨‰∏Ä‰∏™‰ΩçÁΩÆ -->
          <div 
            class="color-card current-edit-card"
            :style="{ backgroundColor: getColorWithAlpha(currentColor) }"
          >
            <div class="color-info">
              <div class="color-hex">HEX: {{ currentColor.hex }}</div>
              <div class="color-rgb">RGB: {{ currentColor.rgb.r }}, {{ currentColor.rgb.g }}, {{ currentColor.rgb.b }}</div>
              <div v-if="showCmyk" class="color-cmyk">
                CMYK: {{ currentColor.cmyk.c }}%, {{ currentColor.cmyk.m }}%, {{ currentColor.cmyk.y }}%, {{ currentColor.cmyk.k }}%
              </div>
              <div class="color-note">{{ currentColor.note || 'Âü∫Á°ÄËâ≤' }}</div>
            </div>
          </div>
          
          <div 
            v-for="card in colorCards" 
            :key="card.id" 
            class="color-card"
            :class="{ 'locked': card.locked }"
            :style="{ backgroundColor: getColorWithAlpha(card) }"
          >
            <div class="color-info">
              <div class="color-hex">HEX: {{ card.hex }}</div>
              <div class="color-rgb">RGB: {{ card.rgb.r }}, {{ card.rgb.g }}, {{ card.rgb.b }}</div>
              <div v-if="showCmyk" class="color-cmyk">
                CMYK: {{ card.cmyk.c }}%, {{ card.cmyk.m }}%, {{ card.cmyk.y }}%, {{ card.cmyk.k }}%
              </div>
              <div v-if="card.note" class="color-note">{{ card.note }}</div>
            </div>
            <div class="card-actions">
              <button @click="toggleLock(card.id)" class="action-btn" :title="card.locked ? 'Ëß£ÈîÅËâ≤Âç°' : 'ÈîÅÂÆöËâ≤Âç°'">
                <span>{{ card.locked ? 'üîí' : 'üîì' }}</span>
              </button>
              <button @click="copyColor(card.hex)" class="action-btn" title="Â§çÂà∂Ëâ≤ÂÄº">
                <span>üìã</span>
              </button>
              <button @click="removeColorCard(card.id)" class="action-btn" title="Âà†Èô§Ëâ≤Âç°">
                <span>üóëÔ∏è</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Ëá™ÂÆö‰πâÊèêÁ§∫Ê°Ü -->
    <div v-if="showToastState" class="custom-toast" :class="`toast-${toastType}`">
      <div class="toast-content">
        <div class="toast-icon">
          <svg v-if="toastType === 'success'" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <svg v-else viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 9V13M12 17H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <span class="toast-message">{{ toastMessage }}</span>
        <button @click="showToastState = false" class="toast-close">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive, computed, onMounted } from 'vue';
import chroma from 'chroma-js';

// ÊèêÁ§∫Ê°ÜÁä∂ÊÄÅ
const showToastState = ref(false);
const toastMessage = ref('');
const toastType = ref('success'); // 'success' | 'error'

// ÊòæÁ§∫Ëá™ÂÆö‰πâÊèêÁ§∫Ê°Ü
const showToast = (message, type = 'success') => {
  toastMessage.value = message;
  toastType.value = type;
  showToastState.value = true;
  
  // 3ÁßíÂêéËá™Âä®ÈöêËóè
  setTimeout(() => {
    showToastState.value = false;
  }, 2000);
};

// Âü∫Á°ÄËâ≤Êó∂ÈíüÊï∞ÊçÆ
const basicColors = ref([
  { name: 'Á∫¢Ëâ≤', hex: '#FF0000', rgb: {r: 255, g: 0, b: 0} },
  { name: 'Ê©ôËâ≤', hex: '#FF7F00', rgb: {r: 255, g: 127, b: 0} },
  { name: 'ÈªÑËâ≤', hex: '#FFFF00', rgb: {r: 255, g: 255, b: 0} },
  { name: 'ÈªÑÁªøËâ≤', hex: '#7FFF00', rgb: {r: 127, g: 255, b: 0} },
  { name: 'ÁªøËâ≤', hex: '#00FF00', rgb: {r: 0, g: 255, b: 0} },
  { name: 'ÈùíÁªøËâ≤', hex: '#00FF7F', rgb: {r: 0, g: 255, b: 127} },
  { name: 'ÈùíËâ≤', hex: '#00FFFF', rgb: {r: 0, g: 255, b: 255} },
  { name: 'ÈùíËìùËâ≤', hex: '#007FFF', rgb: {r: 0, g: 127, b: 255} },
  { name: 'ËìùËâ≤', hex: '#0000FF', rgb: {r: 0, g: 0, b: 255} },
  { name: 'ËìùÁ¥´Ëâ≤', hex: '#7F00FF', rgb: {r: 127, g: 0, b: 255} },
  { name: 'Á¥´Ëâ≤', hex: '#FF00FF', rgb: {r: 255, g: 0, b: 255} },
  { name: 'Á¥´Á∫¢Ëâ≤', hex: '#FF007F', rgb: {r: 255, g: 0, b: 127} }
]);

// Ëâ≤Âç°Êï∞ÊçÆ
const colorCards = ref([
  { 
    id: 1, 
    hex: '#E74C3C', 
    rgb: {r: 231, g: 76, b: 60}, 
    cmyk: {c: 0, m: 67, y: 74, k: 9}, 
    lab: {L: 52.3, a: 50.1, b: 35.6}, 
    note: '‰∏ªËâ≤', 
    locked: false,
    alpha: 1
  },
  { 
    id: 2, 
    hex: '#3498DB', 
    rgb: {r: 52, g: 152, b: 219}, 
    cmyk: {c: 76, m: 31, y: 0, k: 14}, 
    lab: {L: 59.6, a: -7.2, b: -41.3}, 
    note: 'ËæÖËâ≤', 
    locked: false,
    alpha: 1
  },
  { 
    id: 3, 
    hex: '#2ECC71', 
    rgb: {r: 46, g: 204, b: 113}, 
    cmyk: {c: 77, m: 0, y: 45, k: 20}, 
    lab: {L: 73.4, a: -48.1, b: 31.4}, 
    note: 'ÁÇπÁºÄËâ≤', 
    locked: false,
    alpha: 1
  }
]);

// ÂΩìÂâçÁºñËæëÁöÑËâ≤Âç°
const currentColor = reactive({
  hex: '#FFFFFF',
  rgb: {r: 255, g: 255, b: 255},
  cmyk: {c: 0, m: 0, y: 0, k: 0},
  lab: {L: 100, a: 0, b: 0},
  note: '',
  alpha: 1
});

// ÈÄèÊòéÂ∫¶ÁôæÂàÜÊØîËÆ°ÁÆóÂ±ûÊÄß
const alphaPercentage = computed({
  get: () => Math.round(currentColor.alpha * 100),
  set: (value) => {
    currentColor.alpha = value / 100;
    updateColorWithAlpha();
  }
});

// Ëâ≤ÂÄºËæìÂÖ•ÊñπÂºè
const inputMethod = ref('hex'); // hex, rgb, cmyk, lab

// Ëâ≤Âç°Êï∞Èáè
const colorCount = ref(5);

// ÂÖ®Â±ÄÂ§áÊ≥®
const globalNote = ref('');

// ÊòØÂê¶ÊòæÁ§∫CMYKÂÄº
const showCmyk = ref(true);

// Ëâ≤Âç°Â∏ÉÂ±ÄÊñπÂºè
const layoutMode = ref('grid'); // grid, row

// Ê∑ªÂä†Êñ∞Ëâ≤Âç°
const addColorCard = () => {
  const newId = colorCards.value.length > 0 
    ? Math.max(...colorCards.value.map(card => card.id)) + 1 
    : 1;
  
  // Ê£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®Áõ∏ÂêåËâ≤ÂÄºÁöÑËâ≤Âç°
  const isDuplicate = colorCards.value.some(card => card.hex.toLowerCase() === currentColor.hex.toLowerCase());
  
  if (isDuplicate) {
    showToast('Â∑≤Â≠òÂú®Áõ∏ÂêåËâ≤ÂÄºÁöÑËâ≤Âç°Ôºå‰∏çËÉΩÈáçÂ§çÊ∑ªÂä†ÔºÅ', 'error');
    return;
  }
  
  colorCards.value.push({
    id: newId,
    hex: currentColor.hex,
    rgb: {...currentColor.rgb},
    cmyk: {...currentColor.cmyk},
    lab: {...currentColor.lab},
    note: currentColor.note,
    locked: false,
    alpha: currentColor.alpha
  });
  
  // ÈáçÁΩÆÂΩìÂâçÁºñËæëÁöÑËâ≤Âç°
  resetCurrentColor();
};

// Ëé∑ÂèñÂ∏¶ÈÄèÊòéÂ∫¶ÁöÑÈ¢úËâ≤ÂÄº
const getColorWithAlpha = (color) => {
  const rgb = color.rgb;
  return `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${color.alpha})`;
};

// Êõ¥Êñ∞È¢úËâ≤Êó∂ÂêåÊó∂ËÄÉËôëÈÄèÊòéÂ∫¶
const updateColorWithAlpha = () => {
  // ÈÄèÊòéÂ∫¶ÊîπÂèòÊó∂Êõ¥Êñ∞È¢ÑËßàÔºå‰ΩÜ‰∏çÊîπÂèòÂü∫Á°ÄËâ≤ÂÄº
  // ÂÆûÈôÖÈ¢úËâ≤ÊòæÁ§∫‰ºöÈÄöËøágetColorWithAlphaÊñπÊ≥ïÂ§ÑÁêÜ
};

// ‰ªéÁôæÂàÜÊØîÊõ¥Êñ∞ÈÄèÊòéÂ∫¶ÂÄº
const updateAlphaFromPercentage = () => {
  currentColor.alpha = alphaPercentage.value / 100;
  updateColorWithAlpha();
};

// ËÆæÁΩÆËâ≤Âç°Êï∞Èáè
const setColorCount = (count) => {
  colorCount.value = count;
};

// È™åËØÅËâ≤Âç°Êï∞ÈáèËæìÂÖ•
const validateColorCount = () => {
  // Á°Æ‰øùËæìÂÖ•ÊòØÊï∞Â≠ó
  const value = parseInt(colorCount.value);
  if (isNaN(value)) {
    colorCount.value = 5; // ÈªòËÆ§ÂÄº
    return;
  }
  
  // ÈôêÂà∂ËåÉÂõ¥Âú®1-100‰πãÈó¥
  if (value < 1) {
    colorCount.value = 1;
  } else if (value > 100) {
    colorCount.value = 100;
  }
};

// Â§çÂà∂Ëâ≤ÂÄºÂà∞Ââ™Ë¥¥Êùø
const copyColor = (color) => {
  navigator.clipboard.writeText(color).then(() => {
    showCopyNotification(color);
  });
};

// ÊòæÁ§∫Â§çÂà∂ÊàêÂäüÈÄöÁü•
const showCopyNotification = (color) => {
  const notification = document.createElement('div');
  notification.className = 'copy-notification';
  notification.innerHTML = `
    <div class="notification-content">
      <div class="color-dot" style="background-color: ${color}"></div>
      <span>Â∑≤Â§çÂà∂Ëâ≤ÂÄº: ${color}</span>
    </div>
  `;
  document.body.appendChild(notification);
  
  // Ê∑ªÂä†Âä®ÁîªÊïàÊûú
  setTimeout(() => {
    notification.classList.add('show');
  }, 10);
  
  // 2ÁßíÂêéÁßªÈô§ÈÄöÁü•
  setTimeout(() => {
    notification.classList.remove('show');
    notification.classList.add('hide');
    setTimeout(() => {
      document.body.removeChild(notification);
    }, 300);
  }, 2000);
};
// ‰ªéÂü∫Á°ÄËâ≤Êó∂ÈíüÈÄâÊã©È¢úËâ≤
const selectBasicColor = (color) => {
  currentColor.hex = color.hex;
  currentColor.rgb = {...color.rgb};
  // Êõ¥Êñ∞ÂÖ∂‰ªñÈ¢úËâ≤Ê†ºÂºè
  handleHexChange();
};
const resetCurrentColor = () => {
  currentColor.hex = '#FFFFFF';
  currentColor.rgb = {r: 255, g: 255, b: 255};
  currentColor.cmyk = {c: 0, m: 0, y: 0, k: 0};
  currentColor.lab = {L: 100, a: 0, b: 0};
  currentColor.note = '';
  currentColor.alpha = 1;
};

// Âà†Èô§Ëâ≤Âç°
const removeColorCard = (id) => {
  const index = colorCards.value.findIndex(card => card.id === id);
  if (index !== -1) {
    colorCards.value.splice(index, 1);
  }
};

// ÈîÅÂÆö/Ëß£ÈîÅËâ≤Âç°
const toggleLock = (id) => {
  const card = colorCards.value.find(card => card.id === id);
  if (card) {
    card.locked = !card.locked;
  }
};

// Ëøô‰∏™ÂáΩÊï∞Â∑≤Ë¢´‰∏äÈù¢ÁöÑcopyColorÊõø‰ª£Ôºå‰ΩøÁî®showCopyNotificationÊèê‰æõÊõ¥Â•ΩÁöÑÁî®Êà∑‰ΩìÈ™å

// ‰ªéHEXÊõ¥Êñ∞RGB
const updateRgbFromHex = (hex) => {
  // ÁßªÈô§#Âè∑
  hex = hex.replace('#', '');
  
  // Ëß£ÊûêRGBÂÄº
  const r = parseInt(hex.substring(0, 2), 16);
  const g = parseInt(hex.substring(2, 4), 16);
  const b = parseInt(hex.substring(4, 6), 16);
  
  return {r, g, b};
};

// ‰ªéRGBÊõ¥Êñ∞HEX
const updateHexFromRgb = (r, g, b) => {
  return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`.toUpperCase();
};

// ‰ªéRGBÊõ¥Êñ∞CMYK
const updateCmykFromRgb = (r, g, b) => {
  try {
    // ‰ΩøÁî®chroma.jsËøõË°åËΩ¨Êç¢
    const cmyk = chroma(r, g, b).cmyk();
    return {
      c: Math.round(cmyk[0] * 100),
      m: Math.round(cmyk[1] * 100),
      y: Math.round(cmyk[2] * 100),
      k: Math.round(cmyk[3] * 100)
    };
  } catch (error) {
    // ÂõûÈÄÄÂà∞ÁÆÄÂåñÁâàËΩ¨Êç¢
    const rRatio = r / 255;
    const gRatio = g / 255;
    const bRatio = b / 255;
    
    const k = 1 - Math.max(rRatio, gRatio, bRatio);
    
    if (k === 1) {
      return { c: 0, m: 0, y: 0, k: 100 };
    }
    
    const c = Math.round(((1 - rRatio - k) / (1 - k)) * 100);
    const m = Math.round(((1 - gRatio - k) / (1 - k)) * 100);
    const y = Math.round(((1 - bRatio - k) / (1 - k)) * 100);
    
    return { c, m, y, k: Math.round(k * 100) };
  }
};

// ‰ªéRGBÊõ¥Êñ∞Lab
const updateLabFromRgb = (r, g, b) => {
  try {
    // ‰ΩøÁî®chroma.jsËøõË°åËΩ¨Êç¢
    const lab = chroma(r, g, b).lab();
    return {
      L: Math.round(lab[0] * 10) / 10,
      a: Math.round(lab[1] * 10) / 10,
      b: Math.round(lab[2] * 10) / 10
    };
  } catch (error) {
    // ÂõûÈÄÄÂà∞ÁÆÄÂåñÁâàËΩ¨Êç¢
    // ËøôÈáåÂè™ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÁÆÄÂåñÁöÑËΩ¨Êç¢Ôºå‰∏çÂ§üÁ≤æÁ°Æ
    const L = Math.round((0.2126 * r + 0.7152 * g + 0.0722 * b) / 2.55);
    const a = Math.round((r - g) / 2);
    const b_val = Math.round((g - b) / 2);
    
    return { L, a, b: b_val };
  }
};

// ÁõëÂê¨HEXËæìÂÖ•ÂèòÂåñ
const handleHexChange = () => {
  const rgb = updateRgbFromHex(currentColor.hex);
  currentColor.rgb = rgb;
  currentColor.cmyk = updateCmykFromRgb(rgb.r, rgb.g, rgb.b);
  currentColor.lab = updateLabFromRgb(rgb.r, rgb.g, rgb.b);
};

// ÁõëÂê¨RGBËæìÂÖ•ÂèòÂåñ
const handleRgbChange = () => {
  const {r, g, b} = currentColor.rgb;
  currentColor.hex = updateHexFromRgb(r, g, b);
  currentColor.cmyk = updateCmykFromRgb(r, g, b);
  currentColor.lab = updateLabFromRgb(r, g, b);
};

// ÁõëÂê¨CMYKËæìÂÖ•ÂèòÂåñ
const handleCmykChange = () => {
  // ÁÆÄÂåñÁâàCMYKÂà∞RGBËΩ¨Êç¢
  const {c, m, y, k} = currentColor.cmyk;
  
  const r = Math.round(255 * (1 - c/100) * (1 - k/100));
  const g = Math.round(255 * (1 - m/100) * (1 - k/100));
  const b = Math.round(255 * (1 - y/100) * (1 - k/100));
  
  currentColor.rgb = {r, g, b};
  currentColor.hex = updateHexFromRgb(r, g, b);
  currentColor.lab = updateLabFromRgb(r, g, b);
};

// ÁõëÂê¨LabËæìÂÖ•ÂèòÂåñ
const handleLabChange = () => {
  try {
    // ‰ΩøÁî®chroma.jsËøõË°åËΩ¨Êç¢
    const rgb = chroma.lab(currentColor.lab.L, currentColor.lab.a, currentColor.lab.b).rgb();
    
    currentColor.rgb = {
      r: Math.round(rgb[0]),
      g: Math.round(rgb[1]),
      b: Math.round(rgb[2])
    };
    
    const {r, g, b} = currentColor.rgb;
    currentColor.hex = updateHexFromRgb(r, g, b);
    currentColor.cmyk = updateCmykFromRgb(r, g, b);
  } catch (error) {
    console.error('LabËΩ¨Êç¢ÈîôËØØ:', error);
  }
};

// ÁîüÊàêÁõ∏‰ººÈ¢úËâ≤
const generateSimilarColors = () => {
  const baseColor = currentColor.hex;
  const count = colorCount.value;
  
  try {
    // ‰ΩøÁî®chroma.jsÁîüÊàêËâ≤Èò∂
    const scale = chroma.scale([
      chroma(baseColor).brighten(2),
      baseColor,
      chroma(baseColor).darken(2)
    ]).mode('lab').colors(count);
    
    // Ê∏ÖÁ©∫Áé∞ÊúâËâ≤Âç°
    colorCards.value = [];
    
    // Ê∑ªÂä†ÁîüÊàêÁöÑËâ≤Âç°
    scale.forEach((color, index) => {
      const hex = color.toUpperCase();
      const rgb = updateRgbFromHex(hex);
      const cmyk = updateCmykFromRgb(rgb.r, rgb.g, rgb.b);
      const lab = updateLabFromRgb(rgb.r, rgb.g, rgb.b);
      
      colorCards.value.push({
        id: index + 1,
        hex,
        rgb,
        cmyk,
        lab,
        note: '',
        locked: false,
        alpha: currentColor.alpha // ‰øùÊåÅ‰∏éÂΩìÂâçÁºñËæëÈ¢úËâ≤Áõ∏ÂêåÁöÑÈÄèÊòéÂ∫¶
      });
    });
  } catch (error) {
    console.error('ÁîüÊàêÁõ∏‰ººËâ≤Âç°ÈîôËØØ:', error);
  }
};

// ÂØºÂá∫Ëâ≤Âç°
const exportColorCards = () => {
  // Ê£ÄÊü•ÂÖ®Â±ÄÂ§áÊ≥®ÊòØÂê¶Â°´ÂÜô
  if (!globalNote.value.trim()) {
    showToast('ËØ∑Â°´ÂÜôÂÖ®Â±ÄÂ§áÊ≥®ÔºåËøôÊòØÂøÖÈ°ªÁöÑÔºÅ', 'error');
    return;
  }
  
  // ÂàõÂª∫‰∏Ä‰∏™‰∏¥Êó∂ÂÆπÂô®Êù•Ê∏≤ÊüìÂØºÂá∫ÂÜÖÂÆπ
  const exportContainer = document.createElement('div');
  exportContainer.className = 'export-container';
  
  // Ê∑ªÂä†Ê†áÈ¢òÂíåÂÖ®Â±ÄÂ§áÊ≥®
  const header = document.createElement('div');
  header.className = 'export-header';
  header.innerHTML = `
    <h1>üé® Ëâ≤Âç°</h1>
    ${globalNote.value ? `<p class="export-note">${globalNote.value}</p>` : ''}
    <p class="export-date">ÂØºÂá∫Êó∂Èó¥: ${new Date().toLocaleString()}</p>
  `;
  exportContainer.appendChild(header);
  
  // Ê∑ªÂä†Ëâ≤Âç° - ‰ΩøÁî®Â∑¶ÂØπÈΩêÂ∏ÉÂ±Ä
  const cardsContainer = document.createElement('div');
  cardsContainer.className = 'export-cards';
  
  // ËÆ°ÁÆóÊØèË°åÊòæÁ§∫ÁöÑËâ≤Âç°Êï∞Èáè
  const cardsPerRow = 5; // ÊØèË°åÊúÄÂ§öÊòæÁ§∫5‰∏™Ëâ≤Âç°
  
  // ÂàõÂª∫Ë°åÂÆπÂô®
  let currentRow = null;
  
  // ÂàõÂª∫Ë¶ÅÂØºÂá∫ÁöÑËâ≤Âç°Êï∞ÁªÑÔºåÈ¶ñÂÖàÊ∑ªÂä†Âü∫Á°ÄËâ≤
  const cardsToExport = [
    {
      id: 0,
      hex: currentColor.hex,
      rgb: currentColor.rgb,
      cmyk: currentColor.cmyk,
      lab: currentColor.lab,
      note: 'Âü∫Á°ÄËâ≤',
      locked: false,
      alpha: currentColor.alpha
    },
    ...colorCards.value
  ];
  
  cardsToExport.forEach((card, index) => {
    // ÊØèË°åÂºÄÂßãÊó∂ÂàõÂª∫Êñ∞ÁöÑË°åÂÆπÂô®
    if (index % cardsPerRow === 0) {
      currentRow = document.createElement('div');
      currentRow.className = 'export-row';
      currentRow.style.justifyContent = 'flex-start'; // ËÆæÁΩÆ‰∏∫Â∑¶ÂØπÈΩê
      cardsContainer.appendChild(currentRow);
    }
    
    const cardElement = document.createElement('div');
    cardElement.className = 'export-card';
    cardElement.style.backgroundColor = card.hex;
    
    const cardInfo = document.createElement('div');
    cardInfo.className = 'export-card-info';
    cardInfo.innerHTML = `
      <div class="export-hex">${card.hex}</div>
      <div class="export-rgb">RGB: ${card.rgb.r}, ${card.rgb.g}, ${card.rgb.b}</div>
      <div class="export-cmyk">CMYK: ${card.cmyk.c}%, ${card.cmyk.m}%, ${card.cmyk.y}%, ${card.cmyk.k}%</div>
      ${card.note ? `<div class="export-card-note">${card.note}</div>` : ''}
    `;
    
    cardElement.appendChild(cardInfo);
    currentRow.appendChild(cardElement);
  });
  
  exportContainer.appendChild(cardsContainer);
  
  // Ê∑ªÂä†Ê†∑Âºè
  const style = document.createElement('style');
  style.textContent = `
    .export-container {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 30px;
      background-color: white;
      max-width: 1000px;
      margin: 0 auto;
    }
    .export-header {
      text-align: center;
      margin-bottom: 30px;
    }
    .export-header h1 {
      font-size: 28px;
      color: #2c3e50;
      margin-bottom: 10px;
    }
    .export-note {
      font-style: italic;
      color: #666;
      margin-bottom: 10px;
    }
    .export-date {
      font-size: 0.8em;
      color: #999;
    }
    .export-cards {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    .export-row {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
    }
    .export-card {
      width: 160px;
      height: 160px;
      border-radius: 8px;
      padding: 0;
      box-shadow: 0 3px 8px rgba(0,0,0,0.15);
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
    }
    .export-card-info {
      background-color: rgba(255, 255, 255, 0.9);
      padding: 10px;
      border-radius: 0 0 8px 8px;
      font-size: 12px;
    }
    .export-hex {
      font-weight: bold;
      font-size: 14px;
      margin-bottom: 3px;
    }
    .export-card-note {
      font-style: italic;
      margin-top: 4px;
      font-size: 11px;
      color: #666;
    }
  `;
  exportContainer.appendChild(style);
  
  // Â∞ÜÂÆπÂô®Ê∑ªÂä†Âà∞ÊñáÊ°£‰∏≠Ôºà‰ΩÜ‰∏çÂèØËßÅÔºâ
  document.body.appendChild(exportContainer);
  exportContainer.style.position = 'absolute';
  exportContainer.style.left = '-9999px';
  
  // ‰ΩøÁî®html2canvasÂ∞ÜÂÆπÂô®ËΩ¨Êç¢‰∏∫ÂõæÁâá
  import('html2canvas').then(html2canvasModule => {
    const html2canvas = html2canvasModule.default;
    
    html2canvas(exportContainer, {
      backgroundColor: '#ffffff',
      scale: 2, // ÊèêÈ´òÂØºÂá∫ÂõæÁâáË¥®Èáè
      logging: false,
      allowTaint: true,
      useCORS: true
    }).then(canvas => {
      // ÂàõÂª∫‰∏ãËΩΩÈìæÊé•
      const link = document.createElement('a');
      link.download = `Ëâ≤Âç°_${new Date().toISOString().slice(0, 10)}.png`;
      link.href = canvas.toDataURL('image/png');
      link.click();
      
      // Ê∏ÖÁêÜDOM
      document.body.removeChild(exportContainer);
    }).catch(error => {
      console.error('ÂØºÂá∫ÂõæÁâáÂ§±Ë¥•:', error);
      showToast('ÂØºÂá∫ÂõæÁâáÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÂÜçËØï', 'error');
      document.body.removeChild(exportContainer);
    });
  }).catch(() => {
    showToast('Ê≠£Âú®Âä†ËΩΩÂØºÂá∫ÂäüËÉΩÔºåËØ∑Á®çÂêéÂÜçËØï...', 'error');
    document.body.removeChild(exportContainer);
  });
};

onMounted(() => {
  // ÂàùÂßãÂåñÊìç‰Ωú
  handleHexChange();
});
</script>

<style scoped>
.color-card-container {
  max-width: 1200px;
  margin: 0 auto;
  margin-top: 30px;
  padding: 20px;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: #333;
  background-color: #f8f9fa;
  border-radius: 12px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
}

h1, h2 {
  color: #2c3e50;
  margin-bottom: 20px;
  font-weight: 600;
}

h1 {
  text-align: center;
  font-size: 2.2rem;
  margin-bottom: 30px;
  background: linear-gradient(45deg, #3498db, #9b59b6);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  padding: 10px 0;
}

h2 {
  font-size: 1.5rem;
  border-bottom: 2px solid #e0e0e0;
  padding-bottom: 10px;
  margin-top: 0;
}

/* Êñ∞ÁöÑÂ∑¶Âè≥Â∏ÉÂ±Ä */
.main-layout {
  display: flex;
  gap: 25px;
}

.left-panel {
  flex: 0 0 350px;
}

.right-panel {
  flex: 1;
  min-width: 300px;
}

.tool-panel {
  background-color: white;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
}

.panel-section {
  padding: 15px;
  background-color: #f9f9f9;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.03);
  margin-bottom: 20px;
}

.panel-section:last-child {
  margin-bottom: 0;
}

.input-method-selector {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
  flex-wrap: wrap;
}

.input-method {
  padding: 8px 15px;
  background-color: #f1f1f1;
  border: none;
  border-radius: 20px;
  cursor: pointer;
  font-weight: 500;
  transition: all 0.2s ease;
  flex: 1;
  min-width: 60px;
  text-align: center;
}

.input-method:hover {
  background-color: #e0e0e0;
}

.input-method.active {
  background-color: #3498db;
  color: white;
  box-shadow: 0 2px 5px rgba(52, 152, 219, 0.3);
}

.input-group {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 10px;
  align-items: center;
  margin-bottom: 15px;
  padding: 10px;
  background-color: white;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.input-group label {
  font-weight: 500;
  color: #555;
  min-width: 30px;
}

.input-group input[type="text"],
.input-group input[type="number"] {
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 14px;
  transition: border 0.2s;
}

.input-group input[type="text"]:focus,
.input-group input[type="number"]:focus {
  border-color: #3498db;
  outline: none;
  box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
}

.color-input-wrapper {
  display: flex;
  align-items: center;
  gap: 10px;
  position: relative;
}

.color-picker.modern-picker {
  width: 40px;
  height: 40px;
  border: #3498db 2px solid;
  border-radius: 50%;
  overflow: hidden;
  cursor: pointer;
  appearance: none;
  -webkit-appearance: none;
  padding: 0;
  background: none;
}

.color-picker.modern-picker::-webkit-color-swatch-wrapper {
  padding: 0;
}

.color-picker.modern-picker::-webkit-color-swatch {
  border: none;
  border-radius: 50%;
  box-shadow: 0 0 0 2px white, 0 0 0 3px #ddd;
}

.color-preview {
  width: 40px;
  height: 40px;
  border-radius: 8px;
  align-self: self-end;
  box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1), 0 2px 5px rgba(0, 0, 0, 0.1);
  transition: transform 0.2s;
}

.color-preview:hover {
  transform: scale(1.1);
}

.note-input {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 10px;
  align-items: center;
  margin-bottom: 15px;
  padding: 10px;
  background-color: white;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.note-input input {
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 14px;
}

.add-button {
  width: 100%;
  padding: 12px;
  background: linear-gradient(45deg, #3498db, #2980b9);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  margin-top: 10px;
  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
}

.add-button:hover {
  background: linear-gradient(45deg, #2980b9, #3498db);
  transform: translateY(-2px);
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
}

.add-button:active {
  transform: translateY(0);
}

.color-count-control,
.layout-control,
.global-note {
  margin-bottom: 20px;
  padding: 15px;
  background-color: white;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.color-count-control {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.color-count-control label {
  font-weight: 600;
  color: #333;
}

.preset-container {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-bottom: 15px;
}

.preset-buttons {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.preset-btn {
  flex: 1;
  min-width: 40px;
  padding: 8px 0;
  background-color: #f5f5f5;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.preset-btn:hover {
  background-color: #e9e9e9;
  border-color: #ccc;
}

.preset-btn:active {
  background-color: #3498db;
  color: white;
  border-color: #3498db;
}

.custom-count-input {
  width: 100%;
}

.custom-input {
  width: 100%;
  padding: 8px 0;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 14px;
  text-align: center;
}

.layout-control {
  display: flex;
  align-items: center;
  gap: 10px;
}

.layout-control button,
.color-count-control button {
  padding: 8px 15px;
  background-color: #f1f1f1;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
}

.layout-control button:hover,
.color-count-control button:hover {
  background-color: #e0e0e0;
}

.layout-control button.active {
  background-color: #3498db;
  color: white;
}

.global-note {
  display: grid;
  grid-template-rows: auto 1fr;
  gap: 10px;
}

.global-note textarea {
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 6px;
  resize: vertical;
  min-height: 80px;
  font-family: inherit;
}

.global-note label::after {
  content: ' *';
  color: #e74c3c;
  font-weight: bold;
}

.alpha-input-container {
  display: flex;
  align-items: center;
  gap: 10px;
  width: 100%;
}

.alpha-value-input {
  display: flex;
  align-items: center;
  min-width: 60px;
}

.alpha-percentage-input {
  width: 40px;
  text-align: right;
  padding: 4px;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.export-control {
  text-align: center;
}

.export-button {
  padding: 12px 25px;
  background: linear-gradient(45deg, #9b59b6, #8e44ad);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
}

.export-button:hover {
  background: linear-gradient(45deg, #8e44ad, #9b59b6);
  transform: translateY(-2px);
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
}

.color-cards-display {
  display: grid;
  gap: 20px;
  margin-top: 30px;
}

.color-cards-display.grid {
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
}

.color-cards-display.row {
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
}

.color-card {
  position: relative;
  height: 180px;
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  overflow: hidden;
  transition: all 0.3s ease;
}

.color-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
}

.color-card.locked {
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1), 0 0 0 3px #f39c12;
}

.color-info {
  background-color: rgba(255, 255, 255, 0.9);
  padding: 12px;
  border-radius: 8px 8px 0 0;
  backdrop-filter: blur(5px);
  transition: transform 0.3s;
  color: #333;
  text-align: left;
}

.color-card:hover .color-info {
  transform: translateY(0);
}

.color-hex {
  font-weight: bold;
  font-size: 16px;
  margin-bottom: 5px;
}

.color-rgb, .color-cmyk {
  font-size: 12px;
  color: #555;
  margin-bottom: 3px;
}

.color-note {
  font-style: italic;
  font-size: 12px;
  color: #777;
  margin-top: 5px;
  border-top: 1px dashed #ddd;
  padding-top: 5px;
}

.card-actions {
  position: absolute;
  top: 10px;
  right: 10px;
  display: flex;
  gap: 5px;
  opacity: 0;
  transition: opacity 0.2s;
}

.color-card:hover .card-actions {
  opacity: 1;
}

.action-btn {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  border: none;
  background-color: rgba(255, 255, 255, 0.8);
  backdrop-filter: blur(5px);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  transition: all 0.2s;
}

.action-btn:hover {
  background-color: white;
  transform: scale(1.1);
}

/* Â§çÂà∂ÈÄöÁü•Ê†∑Âºè */
.copy-notification {
  position: fixed;
  bottom: 20px;
  left: 20px;
  background-color: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 0;
  border-radius: 8px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
  z-index: 9999;
  transform: translateY(100px);
  opacity: 0;
  transition: all 0.3s ease;
}

.copy-notification.show {
  transform: translateY(0);
  opacity: 1;
}

.copy-notification.hide {
  transform: translateY(100px);
  opacity: 0;
}

.notification-content {
  display: flex;
  align-items: center;
  padding: 12px 16px;
  gap: 10px;
}

.color-dot {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border: 2px solid white;
}

/* È´òÁ´ØÊèêÁ§∫Ê°ÜÊ†∑Âºè */
.custom-toast {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 9999;
  min-width: 320px;
  max-width: 500px;
  backdrop-filter: blur(20px);
  border-radius: 16px;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.1);
  animation: toastSlideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  overflow: hidden;
}

.toast-content {
  display: flex;
  align-items: center;
  padding: 16px 20px;
  gap: 12px;
}

.toast-success {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.95) 0%, rgba(21, 128, 61, 0.95) 100%);
  border: 1px solid rgba(34, 197, 94, 0.3);
}

.toast-error {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.95) 0%, rgba(185, 28, 28, 0.95) 100%);
  border: 1px solid rgba(239, 68, 68, 0.3);
}

.toast-icon {
  width: 24px;
  height: 24px;
  color: white;
  flex-shrink: 0;
}

.toast-icon svg {
  width: 100%;
  height: 100%;
}

.toast-message {
  color: white;
  font-size: 15px;
  font-weight: 500;
  line-height: 1.4;
  flex: 1;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.toast-close {
  width: 20px;
  height: 20px;
  background: none;
  border: none;
  color: rgba(255, 255, 255, 0.8);
  cursor: pointer;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.toast-close:hover {
  background: rgba(255, 255, 255, 0.1);
  color: white;
  transform: scale(1.1);
}

.toast-close svg {
  width: 14px;
  height: 14px;
}

@keyframes toastSlideIn {
  from {
    transform: translateX(100%) scale(0.9);
    opacity: 0;
  }
  to {
    transform: translateX(0) scale(1);
    opacity: 1;
  }
}

/* ÂìçÂ∫îÂºèÂ∏ÉÂ±ÄË∞ÉÊï¥ */
@media (max-width: 900px) {
  .main-layout {
    flex-direction: column;
  }
  
  .left-panel {
    flex: 0 0 100%;
  }
  
  .right-panel {
    width: 100%;
  }
}

@media (max-width: 768px) {
  .tool-panel {
    grid-template-columns: 1fr;
  }
  
  .color-cards-display.grid,
  .color-cards-display.row {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  }
  
  .custom-toast {
    top: 10px;
    right: 10px;
    left: 10px;
    min-width: auto;
    max-width: none;
  }
  
  .toast-content {
    padding: 14px 16px;
  }
  
  .toast-message {
    font-size: 14px;
  }
}

@media (max-width: 600px) {
  .color-cards-display {
    grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
  }
  
  .input-group {
    grid-template-columns: 1fr;
  }
  
  .color-count-control {
    grid-template-columns: 1fr;
  }
  
  h1 {
    font-size: 1.8rem;
  }
}
</style>